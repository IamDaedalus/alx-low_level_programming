low level more functions and nested loops
